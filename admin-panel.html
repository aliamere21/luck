<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† - Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</title>
    <style>
        body {
            background: #1a1a32;
            color: #f4faff;
            font-family: 'Cairo', Tahoma, Arial, sans-serif;
            margin: 0; padding: 0;
        }
        .admin-panel {
            max-width: 500px;
            margin: 30px auto;
            background: #232946;
            border-radius: 18px;
            box-shadow: 0 6px 32px #000a;
            padding: 26px 18px 22px 18px;
        }
        h2 {
            color: #00ffd0;
            margin-bottom: 12px;
        }
        input, button, select {
            font-size: 1.05rem;
            padding: 7px 13px;
            margin: 4px 0;
            border-radius: 7px;
            border: none;
            outline: none;
        }
        input, select { width: 70%; }
        button {
            background: linear-gradient(90deg, #00ffd0, #ffe066);
            color: #232946;
            font-weight: bold;
            cursor: pointer;
            margin: 7px 2px;
            border-bottom: 2.5px solid #ffe066aa;
        }
        .users-list {
            margin-top: 18px;
        }
        table {
            width: 100%;
            background: #1a1a32;
            border-radius: 10px;
            margin-top: 8px;
            border-collapse: collapse;
        }
        th, td {
            padding: 7px 5px;
            text-align: center;
        }
        th {
            background: #232946;
            color: #ffe066;
        }
        tr:nth-child(even) { background: #23294644;}
        tr:hover { background: #23294666;}
        .admin-actions button {
            font-size: 0.95em;
            padding: 5px 12px;
            margin: 0 2px;
        }
        .msg {
            margin: 12px 0 0 0;
            font-size: 1.09em;
            color: #ffe066;
        }
    </style>
</head>
<body>
    <div class="admin-panel">
        <h2>ğŸ‘‘ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
        <form id="userForm" onsubmit="return false;">
            <input type="text" id="userIdInput" placeholder="Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (userId)">
            <input type="number" min="0" id="attemptsInput" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª">
            <button onclick="setAttempts()">ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</button>
            <button onclick="restoreAttempt()">Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø­Ø§ÙˆÙ„Ø© (1)</button>
            <button onclick="resetAttempts()">ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª (0)</button>
        </form>
        <div class="msg" id="msg"></div>
        <div class="users-list" id="usersList"></div>
    </div>
<script>
// --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ---
function setUserAttempts(userId, value) {
    let users = localStorage.getItem("gameAttemptsUsers");
    users = users ? JSON.parse(users) : {};
    users[userId] = value;
    localStorage.setItem("gameAttemptsUsers", JSON.stringify(users));
}
function getUserAttempts(userId) {
    let users = localStorage.getItem("gameAttemptsUsers");
    users = users ? JSON.parse(users) : {};
    return typeof users[userId] === "undefined" ? 1 : users[userId];
}
function resetUserAttempts(userId) { setUserAttempts(userId, 0); }
function restoreUserAttempt(userId) { setUserAttempts(userId, 1); }
function getAllUsers() {
    let users = localStorage.getItem("gameAttemptsUsers");
    users = users ? JSON.parse(users) : {};
    return users;
}
function deleteUser(userId) {
    let users = localStorage.getItem("gameAttemptsUsers");
    users = users ? JSON.parse(users) : {};
    delete users[userId];
    localStorage.setItem("gameAttemptsUsers", JSON.stringify(users));
}

// --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø¯Ù…Ù† ---
function setAttempts() {
    let userId = document.getElementById('userIdInput').value.trim();
    let val = Number(document.getElementById('attemptsInput').value);
    if (!userId || isNaN(val) || val < 0) {
        showMsg("Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù ÙˆØ¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª ØµØ­ÙŠØ­.");
        return false;
    }
    setUserAttempts(userId, val);
    showMsg("ØªÙ… ØªØ¹ÙŠÙŠÙ† " + val + " Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… " + userId);
    refreshUsers();
    return false;
}
function restoreAttempt() {
    let userId = document.getElementById('userIdInput').value.trim();
    if (!userId) { showMsg("Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…!"); return false; }
    restoreUserAttempt(userId);
    showMsg("ØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø­Ø§ÙˆÙ„Ø© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… " + userId);
    refreshUsers();
    return false;
}
function resetAttempts() {
    let userId = document.getElementById('userIdInput').value.trim();
    if (!userId) { showMsg("Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…!"); return false; }
    resetUserAttempts(userId);
    showMsg("ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… " + userId);
    refreshUsers();
    return false;
}
function showMsg(msg) {
    let el = document.getElementById('msg');
    el.textContent = msg;
    setTimeout(()=>{el.textContent=''}, 3200);
}
function refreshUsers() {
    let users = getAllUsers();
    let html = "<h3>ÙƒÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h3>";
    let keys = Object.keys(users);
    if (keys.length === 0) {
        html += "<div>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø¹Ø¯.</div>";
    } else {
        html += `<table>
            <tr><th>Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr>`;
        keys.forEach(userId => {
            html += `<tr>
                <td>${userId}</td>
                <td>${users[userId]}</td>
                <td class="admin-actions">
                    <button onclick="restoreUserAttempt('${userId}');refreshUsers();">1 Ù…Ø­Ø§ÙˆÙ„Ø©</button>
                    <button onclick="resetUserAttempts('${userId}');refreshUsers();">ØªØµÙÙŠØ±</button>
                    <button onclick="deleteUser('${userId}');refreshUsers();">Ø­Ø°Ù</button>
                </td>
            </tr>`;
        });
        html += "</table>";
    }
    document.getElementById('usersList').innerHTML = html;
}
window.restoreUserAttempt = restoreUserAttempt;
window.resetUserAttempts = resetUserAttempts;
window.deleteUser = deleteUser;
window.refreshUsers = refreshUsers;

document.addEventListener('DOMContentLoaded', refreshUsers);
</script>
</body>
</html>
